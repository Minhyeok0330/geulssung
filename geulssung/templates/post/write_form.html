{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>글쓰기 ✍️</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Gowun+Batang&display=swap');
    body { font-family: 'Gowun Batang', serif; }
  </style>
</head>
<body class="bg-[#FFF9F2] min-h-screen p-8">

  <div class="max-w-2xl mx-auto bg-white shadow-xl rounded-xl p-6 space-y-6">
    <form method="post" action="">
      {% csrf_token %}
      <!-- 제목 -->
      <div>
        <label class="block font-semibold text-[#493E3E] mb-1">제목</label>
        <input type="text" name="title" class="w-full border px-3 py-2 rounded-md" required />
      </div>

      <!-- 형식 선택 -->
      <!-- 1단계: 상위 카테고리 -->
      <div class="mb-6">
          <p class="font-semibold text-[#493E3E]">오늘의 글쓰기 도우미</p>
          <div class="flex gap-4">
              <label><input type="radio" name="category" value="emotion" onchange="showGenres(this.value)"> F감성 글썽이</label>
            <label><input type="radio" name="category" value="logic" onchange="showGenres(this.value)"> T감성 말썽이</label>
          </div>
        </div>
        
        <!-- 2단계: 하위 장르 -->
        <div class="mb-6" id="genre-emotion" style="display:none;">
          <p class="font-semibold text-[#493E3E]">형식을 골라보세요 (글썽이)</p>
          <div class="flex gap-4">
            <label><input type="radio" name="genre" value="essay" onchange="showGuide(this.value)"> 에세이</label>
            <label><input type="radio" name="genre" value="poem" onchange="showGuide(this.value)"> 시</label>
          </div>
        </div>
      
        <div class="mb-6" id="genre-logic" style="display:none;">
          <p class="font-semibold text-[#493E3E]">형식을 골라보세요 (말썽이)</p>
          <div class="flex gap-4">
            <label><input type="radio" name="genre" value="column" onchange="showGuide(this.value)"> 칼럼</label>
            <label><input type="radio" name="genre" value="analysis" onchange="showGuide(this.value)"> 분석글</label>
          </div>
        </div>
        
        

      <!-- 가이드 + 작성 모듈 (단계별 분할) -->
      <div id="guide-box">
        <div id="guide-column" style="display:none">{% include "post/_guide_column.html" %}</div>
        <div id="guide-analysis" style="display:none">{% include "post/_guide_analysis.html" %}</div>
        <div id="guide-essay" style="display:none">{% include "post/_guide_essay.html" %}</div>
        <div id="guide-poem" style="display:none">{% include "post/_guide_poem.html" %}</div>
      </div>


      <!-- 🧩 최종 통합 작성란 -->
      <div class="mb-8 mt-8">
          <p class="font-bold text-[#493E3E] text-lg mb-2">🧩 글줄기: 하나의 글로 완성해보세요</p>
          <p class="text-sm text-gray-700 mb-3">
          위 단계별 작성 내용을 참고하여, 당신의 생각을 하나의 흐름 있는 글로 정리해보세요.<br />
          이 글은 실제 제출 및 공개 글로 사용될 수 있어요 ✍️
          </p>
          <textarea name="final_text" rows="10" class="w-full border px-4 py-3 rounded-md shadow-sm"></textarea>
      </div>
      

      <!-- 제출 -->
      <div class="text-center">
        <button type="submit" class="bg-[#F9DCC4] hover:bg-[#f7cbaa] text-[#493E3E] font-bold px-6 py-3 rounded-full transition">
          제출하기
        </button>
      </div>
    </form>
  </div>

  <!-- JS: 상위 카테고리 선택 + 형식별 가이드 표시 -->
<script>
    function showGenres(category) {
      // 상위 카테고리에 따라 하위 장르 블록 표시
      document.getElementById('genre-logic').style.display = category === 'logic' ? 'block' : 'none';
      document.getElementById('genre-emotion').style.display = category === 'emotion' ? 'block' : 'none';
  
      // 선택 초기화 (기존 가이드 숨기기)
      const all = ['column', 'analysis', 'essay', 'poem'];
      all.forEach(id => {
        const div = document.getElementById(`guide-${id}`);
        if (div) div.style.display = 'none';
      });
    }
  
    function showGuide(value) {
      // 선택한 장르의 가이드만 보여주기
      const all = ['column', 'analysis', 'essay', 'poem'];
      all.forEach(id => {
        const div = document.getElementById(`guide-${id}`);
        if (div) div.style.display = 'none';
      });
      const target = document.getElementById(`guide-${value}`);
      if (target) target.style.display = 'block';
    }
  </script>
  
</body>
</html>
